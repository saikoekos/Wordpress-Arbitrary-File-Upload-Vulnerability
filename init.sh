#!/bin/bash
# Provisions a Wordpress/Docker development environment

echo "Updating Packages"
sudo apt-get update

echo "Installing apache2..."
sudo apt-get install apache2 apache2-utils 
sudo systemctl enable apache2
sudo systemctl start apache2

echo "Installing mysql..."
sudo apt-get install mysql-client mysql-server

echo "Installing PHP7..."
sudo apt-get install php7.0 php7.0-mysql libapache2-mod-php7.0 php7.0-cli php7.0-cgi php7.0-gd

echo "Downloading latest wordpress..."
wget -c http://wordpress.org/latest.tar.gz
tar -xzvf latest.tar.gz

echo "Adjusting wordpress files..."
sudo tar -zxvf ./CyberSecurity2_Week3/html.tar.gz
sudo rsync -av ./html/* /var/www/html/
sudo chown -R www-data:www-data /var/www/html/
sudo chmod -R 755 /var/www/html/

sudo systemctl restart apache2.service
sudo systemctl restart mysql.service

echo "Setting up MySQL..."
sudo mysql_secure_installation 
